(window.mem=function(){function a(b){var a=new XMLHttpRequest;a.onreadystatechange=function(c){switch(a.readyState){case 1:a.send(b);break;case 4:200==a.status&&(c=JSON.parse(a.responseText),cbf(c.regSuccess))}};a.open("POST",base_url+service_register,!0)}function b(){var a={};FB.getLoginStatus(function(c){"connected"===c.status?a.fbUID=c.authResponse.userID:"not_authorized"===c.status?FB.login(function(a){b()}):(FB.louout(function(){console.log("fbLogOut")}),a=null)});return a}function c(b,a){var c=
new XMLHttpRequest;c.onreadystatechange=function(){switch(c.readyState){case 1:c.send(b);break;case 4:if(200==c.status){var d=c.responseText;JSON.parse(d).loginSuccess&&(kie.setCookieJson(mem.cookieKey,d),a(!0))}else a(!1)}};null!=b?c.open("POST",base_url+service_login,!0):a(!1)}return{cookieKey:jam_cookie_key,login:function(a,e){switch(a.type){case "FB":c(b(),e);break;case "normal":c(a,e)}},logout:function(){kie.cleanCookie(mem.cookieKey,"")},loggedin:function(a){if(""!=kie.getCookieString(mem.cookieKey))if(void 0!=
a)a(document.cookie);else return!0;else return!1},validateAcc:function(a){var b={};b.acc=document.getElementById(field_ACC).value;var c=new XMLHttpRequest;c.onreadystatechange=function(d){switch(c.readyState){case 1:c.send(b);break;case 4:200==c.status&&(d=SON.parse(c.responseText),a(d.accExt))}};c.open("POST",base_url+service_checkACC,!0)},register:function(b,c){switch(b.type){case "FB":b.fbUID=this.getFbInfo();a(b);break;case "normal":a(b)}}}}())(window.bgts=function(){return{taskList:[],bgtLoggedIn:null,
bgtLoggedOut:null,activateBgt:function(a,b){if(0<b.length)for(var c=0;c<b.length;c++)null!=b[c]&&bgts.taskList.push(setInterval(b[c],a))},deActivateBgts:function(){var a=bgts.taskList;if(0<a.length)for(var b=job.length;0<b;b--)clearInterval(a[b-1])}}}())(window.msg=function(){return{checkNewMessage:function(){var a=new XMLHttpRequest;a.onreadystatechange=function(b){switch(a.readyState){case 1:a.send();break;case 4:200==a.status&&JSON.parse(a.responseText);break;default:console.log(a.status)}};a.open("POST",
base_url+service_messagebox,!0)},getMessage:function(){var a={user_id:kie.getCookieJson(mem.cookieKey).user_id,servType:"getMsg",rngStart:msg.msgRng[0]},b=new XMLHttpRequest;b.onreadystatechange=function(c){switch(b.readyState){case 1:b.send(a);break;case 4:200==b.status&&(c=JSON.parse(b.responseText),0<c.result&&(-1!=c.result&&(msg.totalInbox=c.result),null(c)));break;default:console.log(b.status)}};b.open("POST",base_url+service_messagebox,!0)},sendMessage:function(a){var b=new XMLHttpRequest;b.onreadystatechange=
function(a){switch(b.readyState){case 1:b.send();break;case 4:200==b.status&&(a=JSON.parse(b.responseText),0<a.result&&msg.showOnMsgSent(a));break;default:console.log(b.status)}};b.open("POST",base_url+service_sendMsg,!0)},chkMsgBody:function(a){console.log("checked");return!0},checkMailto:function(){console.log("msg.checkMailto : \u6aa2\u67e5\u5bc4\u4ef6\u5c0d\u8c61\u662f\u5426\u5b58\u5728\uff0c\u8003\u616e\u76f4\u63a5\u4f7f\u7528 checkAcc api\uff0c\u76ee\u524d\u76f4\u63a5\u56de\u50b3true");return!0},
showOnCheck:function(a){},showOnNewMessage:null,checkMsgLength:function(a){a=a.value;for(var b=0,c=0;c<a.length;c++)b=127<a.charCodeAt(c)?b+3:b+1;msg.msgLng=b;return b<sys_msg_limit?!0:!1},showOnMsgSent:null,udata:null,isChecking:!1,msgLng:0,msgAll:[],msgRng:[0,0],msgSelected:[],msgTags:[],msgEndPage:[],totalInbox:0,msgLocal:0,idStr:"msg_Id"}}())(window.stater=function(){return{state:"not_initialized",state_li:"logged_in",state_lt:"logged_out",state_ni:"not_initialized",em_for_login:!0,cookieKey:jam_cookie_key,
onLogIn:function(a){a?(stater.showOnLogIn(),bgts.activateBgt(sys_bgt_interval,[bgts.bgtLoggedIn])):console.log("failed to log in")},showOnLogIn:null,showOnLogOut:null,doInit:function(){console.log("init something here and then checkState");stater.state=stater.state_lt},checkState:function(){if(stater.state!=stater.state_ni)switch(mem.loggedin()){case !0:stater.state!=stater.state_li&&(stater.onLogIn(),stater.state=stater.state_li);break;case !1:stater.state!=stater.state_lt&&(stater.onLogOut(),stater.state=
stater.state_lt)}else stater.doInit()}}}())(window.kie=function(){function a(a){for(var b=document.cookie.split(";"),d=0;d<b.length;d++){var e=b[d].split("=");e[0]=e[0].replace(" ","");if(e[0]==a)return a=e[1]}}return{setCookie:function(a,c){document.cookie=a+"="+c+";"},setCookieObj:setCookieObj,getCookieStr:a,getCookieJson:function(b){return JSON.parse(a(b))},cleanCookie:function(a){document.cookie="key=;"}}}());